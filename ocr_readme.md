# Setsuna Discord Bot - OCR 功能說明

## 概述

Setsuna Discord Bot 現在支持 OCR（光學字符識別）功能，可以從用戶上傳的圖片中提取文字。這個功能使用 Tesseract.js 實現，支持多種語言的文字識別，包括英文和繁體中文。

## 安裝步驟

1. 確保已安裝所需依賴：

```bash
npm install tesseract.js@5.0.5
```

2. 確保 `temp` 目錄存在於項目根目錄下（用於存儲臨時圖片文件）：

```bash
mkdir temp
```

## 使用方法

### 基本用法

1. 在 Discord 頻道中上傳一張包含文字的圖片
2. 在消息中包含以下任一關鍵詞：
   - `ocr`
   - `文字識別`
   - `圖片轉文字`
   - `識別圖片`
   - `讀取圖片`
   - `image to text`
   - `read image`
   - `extract text`

3. 機器人將處理圖片並返回識別出的文字

### 示例

```
用戶: [上傳圖片] 請幫我識別這張圖片中的文字

Setsuna: 正在識別圖片中的文字，請稍候...

Setsuna: 圖片文字識別結果：
這是從圖片中識別出的文字內容
多行文字將被保留
```

## 支持的語言

默認情況下，OCR 功能支持英文和繁體中文（`eng+chi_tra`）。如需支持其他語言，可以修改 `ocr.js` 文件中的 `lang` 參數。

## 技術細節

- OCR 引擎：Tesseract.js v5.0.5
- 支持的圖片格式：PNG, JPG, JPEG, GIF, WEBP
- 處理流程：
  1. 下載圖片到臨時目錄
  2. 使用 Tesseract.js 進行文字識別
  3. 返回識別結果
  4. 刪除臨時文件

## 故障排除

如果 OCR 功能無法正常工作，請檢查以下幾點：

1. 確保已安裝 `tesseract.js` 依賴
2. 確保 `temp` 目錄存在且有寫入權限
3. 確保上傳的圖片清晰可讀
4. 檢查控制台日誌中是否有錯誤信息

## 注意事項

- OCR 識別結果的準確性取決於圖片質量和文字清晰度
- 處理大型或高解析度圖片可能需要較長時間
- 識別結果會被添加到消息歷史中，AI 模型可以看到並處理這些文字